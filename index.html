<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>R wrappers for open-meteo.org API • RopenMeteo</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="R wrappers for open-meteo.org API">
<meta name="description" content="This package uses provides R wrappers for the APIs from Open-Meteo project along with helper functions. The Open-Meteo is a project that streamlines access to a range of publicly historical and forecasted meteorology data from agencies across the world.">
<meta property="og:description" content="This package uses provides R wrappers for the APIs from Open-Meteo project along with helper functions. The Open-Meteo is a project that streamlines access to a range of publicly historical and forecasted meteorology data from agencies across the world.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">RopenMeteo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/example_usage.html">Example Usage</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="ropenmeteo">RopenMeteo<a class="anchor" aria-label="anchor" href="#ropenmeteo"></a>
</h1></div>
<!-- badges: start -->

<!-- badges: end -->
<p>R wrappers for APIs on Open-Meteo project. The Open-Meteo is a amazing project that streamlines the access to a range of publicly historical and forecasted meteorology data from agencies across the world. The free access tier allows for 10,000 API calls per day. The paid tiers increase the number of daily API calls (support for paid APIs in this package is pending). Learn more about the Open-Meteo project at their website (<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mi>h</mi><mi>t</mi><mi>t</mi><mi>p</mi><mi>s</mi><mo>:</mo><mi>/</mi><mi>/</mi><mi>o</mi><mi>p</mi><mi>e</mi><mi>n</mi><mo>−</mo><mi>m</mi><mi>e</mi><mi>t</mi><mi>e</mi><mi>o</mi><mi>.</mi><mi>c</mi><mi>o</mi><mi>m</mi><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&lt;https://open-meteo.com&gt;</annotation></semantics></math>) and consider supporting their efforts.</p>
<p>Open-Meteo citation: Zippenfenig, Patrick. (2023). Open-Meteo.com Weather API (0.2.69). Zenodo. <a href="https://doi.org/10.5281/zenodo.8112599" class="external-link uri">https://doi.org/10.5281/zenodo.8112599</a></p>
<p>The package includes additional functionally to facilitate the use in mechanistic environmental/ecological models. This includes the calculation of longwave radiation (not provided through the API) from air temperature and cloud cover, the writing of output to the format required by the General Lake Model (GLM), and the conversion to the standard used in the NEON Ecological Forecasting Challenge that is run by the Ecological Initiative Research Coordination Network (<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mi>h</mi><mi>t</mi><mi>t</mi><mi>p</mi><mi>s</mi><mo>:</mo><mi>/</mi><mi>/</mi><mi>n</mi><mi>e</mi><mi>o</mi><mi>n</mi><mn>4</mn><mi>c</mi><mi>a</mi><mi>s</mi><mi>t</mi><mi>.</mi><mi>o</mi><mi>r</mi><mi>g</mi><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&lt;https://neon4cast.org&gt;</annotation></semantics></math>). Future functionally includes the temporal downscaling of the daily climate projection output and the 6-hourly seasonal forecast to the hourly time step.</p>
<p>The package uses a long format standard with the following columns</p>
<ul>
<li>
<code>datetime</code> = date and time of forecasted value</li>
<li>
<code>reference_datetime</code> = the date and time of the beginning of the forecast (horizon = 0). Does not apply to historical weather.</li>
<li>
<code>site_id</code> = column to identify site location. If null in function call it defaults to latitude_longitude</li>
<li>
<code>model_id</code> = id of model that generated the forecast</li>
<li>
<code>ensemble</code> = ensemble member number (only for ensemble weather and seasonal forecasts)</li>
<li>
<code>variable</code> = forecasted variable</li>
<li>
<code>prediction</code> = forecasted value</li>
<li>
<code>unit</code> = units of the variable</li>
</ul>
<div class="section level2">
<h2 id="install">Install<a class="anchor" aria-label="anchor" href="#install"></a>
</h2>
<pre><code><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"FLARE-forecast/RopenMeteo"</span><span class="op">)</span></span></code></pre>
<pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="weather-forecasts">Weather forecasts<a class="anchor" aria-label="anchor" href="#weather-forecasts"></a>
</h2>
<p>The open-meteo project combines the the best models for each location across the globe to provide the best possible forecast. open-meteo defines this as <code>model = "generic"</code>.</p>
<p><a href="https://open-meteo.com/en/docs" class="external-link uri">https://open-meteo.com/en/docs</a></p>
<pre><code><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">RopenMeteo</span><span class="fu">::</span><span class="fu"><a href="reference/get_forecast.html">get_forecast</a></span><span class="op">(</span>latitude <span class="op">=</span> <span class="fl">37.30</span>,</span>
<span>                               longitude <span class="op">=</span> <span class="op">-</span><span class="fl">79.83</span>,</span>
<span>                               forecast_days <span class="op">=</span> <span class="fl">7</span>,</span>
<span>                               past_days <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                               model <span class="op">=</span> <span class="st">"generic"</span>,</span>
<span>                               variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"temperature_2m"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre>
<pre><code><span><span class="co">## # A tibble: 6 × 7</span></span>
<span><span class="co">##   datetime            reference_datetime  site_id   model_id variable prediction</span></span>
<span><span class="co">##   &lt;dttm&gt;              &lt;dttm&gt;              &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;         &lt;dbl&gt;</span></span>
<span><span class="co">## 1 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79… generic  tempera…       16.6</span></span>
<span><span class="co">## 2 2023-09-23 01:00:00 2023-09-25 00:00:00 37.3_-79… generic  tempera…       16</span></span>
<span><span class="co">## 3 2023-09-23 02:00:00 2023-09-25 00:00:00 37.3_-79… generic  tempera…       15.4</span></span>
<span><span class="co">## 4 2023-09-23 03:00:00 2023-09-25 00:00:00 37.3_-79… generic  tempera…       15.7</span></span>
<span><span class="co">## 5 2023-09-23 04:00:00 2023-09-25 00:00:00 37.3_-79… generic  tempera…       14.7</span></span>
<span><span class="co">## 6 2023-09-23 05:00:00 2023-09-25 00:00:00 37.3_-79… generic  tempera…       14</span></span>
<span><span class="co">## # ℹ 1 more variable: unit &lt;chr&gt;</span></span></code></pre>
<pre><code><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">variable</span>, <span class="va">unit</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">datetime</span>, y <span class="op">=</span> <span class="va">prediction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#F8766D"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">reference_datetime</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">variable</span>, scale <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="ensemble-weather-forecasts">Ensemble Weather Forecasts<a class="anchor" aria-label="anchor" href="#ensemble-weather-forecasts"></a>
</h2>
<p>Ensemble forecasts from individual models are available.</p>
<p><a href="https://open-meteo.com/en/docs/ensemble-api" class="external-link uri">https://open-meteo.com/en/docs/ensemble-api</a></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">RopenMeteo</span><span class="fu">::</span><span class="fu"><a href="reference/get_ensemble_forecast.html">get_ensemble_forecast</a></span><span class="op">(</span></span>
<span>  latitude <span class="op">=</span> <span class="fl">37.30</span>,</span>
<span>  longitude <span class="op">=</span> <span class="op">-</span><span class="fl">79.83</span>,</span>
<span>  forecast_days <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  past_days <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"gfs_seamless"</span>,</span>
<span>  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"temperature_2m"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # A tibble: 6 × 8</span></span>
<span><span class="co">##   datetime            reference_datetime  site_id     model_id ensemble variable</span></span>
<span><span class="co">##   &lt;dttm&gt;              &lt;dttm&gt;              &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;</span></span>
<span><span class="co">## 1 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… 00       tempera…</span></span>
<span><span class="co">## 2 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… 01       tempera…</span></span>
<span><span class="co">## 3 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… 02       tempera…</span></span>
<span><span class="co">## 4 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… 03       tempera…</span></span>
<span><span class="co">## 5 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… 04       tempera…</span></span>
<span><span class="co">## 6 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… 05       tempera…</span></span>
<span><span class="co">## # ℹ 2 more variables: prediction &lt;dbl&gt;, unit &lt;chr&gt;</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">variable</span>, <span class="va">unit</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">datetime</span>, y <span class="op">=</span> <span class="va">prediction</span>, color <span class="op">=</span> <span class="va">ensemble</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">reference_datetime</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">variable</span>, scale <span class="op">=</span> <span class="st">"free"</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>Options for models and variables are at <a href="https://open-meteo.com/en/docs/ensemble-api" class="external-link uri">https://open-meteo.com/en/docs/ensemble-api</a></p>
<p>Note that <code>ecmwf_ifs04</code> does not include solar radiation.</p>
<p>List of global model ids:</p>
<pre><code>icon_seamless, icon_global, gfs_seamless, gfs025, gfs05, ecmwf_ifs04, gem_global</code></pre>
<div class="section level3">
<h3 id="use-with-the-general-lake-model">Use with the General Lake Model<a class="anchor" aria-label="anchor" href="#use-with-the-general-lake-model"></a>
</h3>
<p>We have included functions that allow the output to be used with the General Lake Model (<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mi>h</mi><mi>t</mi><mi>t</mi><mi>p</mi><mi>s</mi><mo>:</mo><mi>/</mi><mi>/</mi><mi>d</mi><mi>o</mi><mi>i</mi><mi>.</mi><mi>o</mi><mi>r</mi><mi>g</mi><mi>/</mi><mn>10.5194</mn><mi>/</mi><mi>g</mi><mi>m</mi><mi>d</mi><mo>−</mo><mn>12</mn><mo>−</mo><mn>473</mn><mo>−</mo><mn>2019</mn><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&lt;https://doi.org/10.5194/gmd-12-473-2019&gt;</annotation></semantics></math>). Since the open-meteo models do not include longwave radiation, the package provides a function to calculate it from the cloud cover and air temperature.</p>
<p>GLM requires a set of variables that are provided</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">RopenMeteo</span><span class="fu">::</span><span class="fu"><a href="reference/get_ensemble_forecast.html">get_ensemble_forecast</a></span><span class="op">(</span></span>
<span>  latitude <span class="op">=</span> <span class="fl">37.30</span>,</span>
<span>  longitude <span class="op">=</span> <span class="op">-</span><span class="fl">79.83</span>,</span>
<span>  forecast_days <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  past_days <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"gfs_seamless"</span>,</span>
<span>  variables <span class="op">=</span> <span class="fu">RopenMeteo</span><span class="fu">::</span><span class="fu"><a href="reference/glm_variables.html">glm_variables</a></span><span class="op">(</span>product <span class="op">=</span> <span class="st">"ensemble_forecast"</span>, </span>
<span>                                        time_step <span class="op">=</span> <span class="st">"hourly"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # A tibble: 6 × 8</span></span>
<span><span class="co">##   datetime            reference_datetime  site_id     model_id ensemble variable</span></span>
<span><span class="co">##   &lt;dttm&gt;              &lt;dttm&gt;              &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;</span></span>
<span><span class="co">## 1 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… 00       relativ…</span></span>
<span><span class="co">## 2 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… 01       relativ…</span></span>
<span><span class="co">## 3 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… 02       relativ…</span></span>
<span><span class="co">## 4 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… 03       relativ…</span></span>
<span><span class="co">## 5 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… 04       relativ…</span></span>
<span><span class="co">## 6 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… 05       relativ…</span></span>
<span><span class="co">## # ℹ 2 more variables: prediction &lt;dbl&gt;, unit &lt;chr&gt;</span></span></code></pre>
<pre><code><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">variable</span>, <span class="va">unit</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">datetime</span>, y <span class="op">=</span> <span class="va">prediction</span>, color <span class="op">=</span> <span class="va">ensemble</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">reference_datetime</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">variable</span>, scale <span class="op">=</span> <span class="st">"free"</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
<p>The following converts to GLM format</p>
<pre><code><span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">RopenMeteo</span><span class="fu">::</span><span class="fu"><a href="reference/add_longwave.html">add_longwave</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">RopenMeteo</span><span class="fu">::</span><span class="fu"><a href="reference/write_glm_format.html">write_glm_format</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">path</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">path</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span>, pattern <span class="op">=</span> <span class="st">".csv"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<pre><code><span><span class="co">##               time AirTemp ShortWave LongWave RelHum WindSpeed Rain</span></span>
<span><span class="co">## 1 2023-09-23 00:00    13.7         0   359.60     67      2.41    0</span></span>
<span><span class="co">## 2 2023-09-23 01:00    12.7         0   357.53     73      2.33    0</span></span>
<span><span class="co">## 3 2023-09-23 02:00    12.3         0   356.12     77      2.38    0</span></span>
<span><span class="co">## 4 2023-09-23 03:00    12.1         0   356.12     79      2.53    0</span></span>
<span><span class="co">## 5 2023-09-23 04:00    12.1         0   356.83     78      2.72    0</span></span>
<span><span class="co">## 6 2023-09-23 05:00    12.2         0   356.83     76      3.07    0</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="converting-to-ecological-forecasting-initative-convention">Converting to Ecological Forecasting Initative convention<a class="anchor" aria-label="anchor" href="#converting-to-ecological-forecasting-initative-convention"></a>
</h3>
<p>The standard used in the NEON Ecological Forecasting Challenge is slightly different from the standard in this package. It uses the column <code>parameter</code> for ensemble because the Challenge standard allows the flexibility to use parametric distributions (i.e., normal distribution <code>mean</code> and <code>sd</code>) in the same standard as a ensemble (or sample) forecast. The <code>family</code> column defines the distribution (here <code>family</code> = <code>ensemble</code>).</p>
<p>The EFI standard also follows CF-conventions so the variable names are converted to be CF compliant.</p>
<p>The output from <code><a href="reference/convert_to_efi_standard.html">RopenMeteo::convert_to_efi_standard()</a></code> is the same as the output from <code>neon4cast::stage2()</code></p>
<p>Learn more about <code>neon4cast::stage2()</code> here: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mi>h</mi><mi>t</mi><mi>t</mi><mi>p</mi><mi>s</mi><mo>:</mo><mi>/</mi><mi>/</mi><mi>p</mi><mi>r</mi><mi>o</mi><mi>j</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>s</mi><mi>.</mi><mi>e</mi><mi>c</mi><mi>o</mi><mi>f</mi><mi>o</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>s</mi><mi>t</mi><mi>.</mi><mi>o</mi><mi>r</mi><mi>g</mi><mi>/</mi><mi>n</mi><mi>e</mi><mi>o</mi><mi>n</mi><mn>4</mn><mi>c</mi><mi>a</mi><mi>s</mi><mi>t</mi><mo>−</mo><mi>d</mi><mi>o</mi><mi>c</mi><mi>s</mi><mi>/</mi><mi>S</mi><mi>h</mi><mi>a</mi><mi>r</mi><mi>e</mi><mi>d</mi><mo>−</mo><mi>F</mi><mi>o</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>s</mi><mi>t</mi><mo>−</mo><mi>D</mi><mi>r</mi><mi>i</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>s</mi><mi>.</mi><mi>h</mi><mi>t</mi><mi>m</mi><mi>l</mi><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&lt;https://projects.ecoforecast.org/neon4cast-docs/Shared-Forecast-Drivers.html&gt;</annotation></semantics></math></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">RopenMeteo</span><span class="fu">::</span><span class="fu"><a href="reference/add_longwave.html">add_longwave</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">RopenMeteo</span><span class="fu">::</span><span class="fu"><a href="reference/convert_to_efi_standard.html">convert_to_efi_standard</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # A tibble: 53,568 × 8</span></span>
<span><span class="co">##    datetime            reference_datetime  site_id     model_id family parameter</span></span>
<span><span class="co">##    &lt;dttm&gt;              &lt;dttm&gt;              &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;</span></span>
<span><span class="co">##  1 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… ensem… 00</span></span>
<span><span class="co">##  2 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… ensem… 00</span></span>
<span><span class="co">##  3 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… ensem… 00</span></span>
<span><span class="co">##  4 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… ensem… 00</span></span>
<span><span class="co">##  5 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… ensem… 00</span></span>
<span><span class="co">##  6 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… ensem… 00</span></span>
<span><span class="co">##  7 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… ensem… 00</span></span>
<span><span class="co">##  8 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… ensem… 00</span></span>
<span><span class="co">##  9 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… ensem… 01</span></span>
<span><span class="co">## 10 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… ensem… 01</span></span>
<span><span class="co">## # ℹ 53,558 more rows</span></span>
<span><span class="co">## # ℹ 2 more variables: variable &lt;chr&gt;, prediction &lt;dbl&gt;</span></span></code></pre>
<p>Note that <code>neon4cast::stage3()</code> is similar to</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">RopenMeteo</span><span class="fu">::</span><span class="fu"><a href="reference/add_longwave.html">add_longwave</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">RopenMeteo</span><span class="fu">::</span><span class="fu"><a href="reference/convert_to_efi_standard.html">convert_to_efi_standard</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">datetime</span> <span class="op">&lt;</span> <span class="va">reference_datetime</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # A tibble: 11,904 × 8</span></span>
<span><span class="co">##    datetime            reference_datetime  site_id     model_id family parameter</span></span>
<span><span class="co">##    &lt;dttm&gt;              &lt;dttm&gt;              &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;</span></span>
<span><span class="co">##  1 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… ensem… 00</span></span>
<span><span class="co">##  2 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… ensem… 00</span></span>
<span><span class="co">##  3 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… ensem… 00</span></span>
<span><span class="co">##  4 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… ensem… 00</span></span>
<span><span class="co">##  5 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… ensem… 00</span></span>
<span><span class="co">##  6 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… ensem… 00</span></span>
<span><span class="co">##  7 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… ensem… 00</span></span>
<span><span class="co">##  8 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… ensem… 00</span></span>
<span><span class="co">##  9 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… ensem… 01</span></span>
<span><span class="co">## 10 2023-09-23 00:00:00 2023-09-25 00:00:00 37.3_-79.83 gfs_sea… ensem… 01</span></span>
<span><span class="co">## # ℹ 11,894 more rows</span></span>
<span><span class="co">## # ℹ 2 more variables: variable &lt;chr&gt;, prediction &lt;dbl&gt;</span></span></code></pre>
<p>With the only difference that the number of days is equal to the <code>past_days</code> in the call to <code><a href="reference/get_ensemble_forecast.html">RopenMeteo::get_ensemble_forecast()</a></code>. The max <code>past_days</code> from open-meteo is ~60 days.</p>
</div>
</div>
<div class="section level2">
<h2 id="historical-weather">Historical Weather<a class="anchor" aria-label="anchor" href="#historical-weather"></a>
</h2>
<p>If you need more historical days for model calibration and testing, historical data are available through open-meteo’s historical weather API.</p>
<p><a href="https://open-meteo.com/en/docs/historical-weather-api" class="external-link uri">https://open-meteo.com/en/docs/historical-weather-api</a></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">RopenMeteo</span><span class="fu">::</span><span class="fu"><a href="reference/get_historical_weather.html">get_historical_weather</a></span><span class="op">(</span></span>
<span>  latitude <span class="op">=</span> <span class="fl">37.30</span>,</span>
<span>  longitude <span class="op">=</span> <span class="op">-</span><span class="fl">79.83</span>,</span>
<span>  start_date <span class="op">=</span> <span class="st">"2023-01-01"</span>,</span>
<span>  end_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"temperature_2m"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # A tibble: 6 × 6</span></span>
<span><span class="co">##   datetime            site_id     model_id variable       prediction unit</span></span>
<span><span class="co">##   &lt;dttm&gt;              &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;               &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">## 1 2023-09-18 18:00:00 37.3_-79.83 ERA5     temperature_2m       21.3 °C</span></span>
<span><span class="co">## 2 2023-09-18 19:00:00 37.3_-79.83 ERA5     temperature_2m       21.5 °C</span></span>
<span><span class="co">## 3 2023-09-18 20:00:00 37.3_-79.83 ERA5     temperature_2m       21.5 °C</span></span>
<span><span class="co">## 4 2023-09-18 21:00:00 37.3_-79.83 ERA5     temperature_2m       21.5 °C</span></span>
<span><span class="co">## 5 2023-09-18 22:00:00 37.3_-79.83 ERA5     temperature_2m       19.5 °C</span></span>
<span><span class="co">## 6 2023-09-18 23:00:00 37.3_-79.83 ERA5     temperature_2m       18.6 °C</span></span></code></pre>
<p>Notice the delay of ~7 days.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">variable</span>, <span class="va">unit</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">datetime</span>, y <span class="op">=</span> <span class="va">prediction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#F8766D"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/with_tz.html" class="external-link">with_tz</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, tzone <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">variable</span>, scale <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 168 rows containing missing values (`geom_line()`).</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="seasonal-forecasts">Seasonal Forecasts<a class="anchor" aria-label="anchor" href="#seasonal-forecasts"></a>
</h2>
<p>Weather forecasts for up to 9 months in the future are available from the NOAA Climate Forecasting System</p>
<p><a href="https://open-meteo.com/en/docs/seasonal-forecast-api" class="external-link uri">https://open-meteo.com/en/docs/seasonal-forecast-api</a></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">RopenMeteo</span><span class="fu">::</span><span class="fu"><a href="reference/get_seasonal_forecast.html">get_seasonal_forecast</a></span><span class="op">(</span></span>
<span>  latitude <span class="op">=</span> <span class="fl">37.30</span>,</span>
<span>  longitude <span class="op">=</span> <span class="op">-</span><span class="fl">79.83</span>,</span>
<span>  forecast_days <span class="op">=</span> <span class="fl">274</span>,</span>
<span>  past_days <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"temperature_2m"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # A tibble: 6 × 8</span></span>
<span><span class="co">##   datetime            reference_datetime  site_id     model_id ensemble variable</span></span>
<span><span class="co">##   &lt;dttm&gt;              &lt;dttm&gt;              &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;</span></span>
<span><span class="co">## 1 2023-09-20 00:00:00 2023-09-25 00:00:00 37.3_-79.83 cfs      01       tempera…</span></span>
<span><span class="co">## 2 2023-09-20 00:00:00 2023-09-25 00:00:00 37.3_-79.83 cfs      02       tempera…</span></span>
<span><span class="co">## 3 2023-09-20 00:00:00 2023-09-25 00:00:00 37.3_-79.83 cfs      03       tempera…</span></span>
<span><span class="co">## 4 2023-09-20 00:00:00 2023-09-25 00:00:00 37.3_-79.83 cfs      04       tempera…</span></span>
<span><span class="co">## 5 2023-09-20 06:00:00 2023-09-25 00:00:00 37.3_-79.83 cfs      01       tempera…</span></span>
<span><span class="co">## 6 2023-09-20 06:00:00 2023-09-25 00:00:00 37.3_-79.83 cfs      02       tempera…</span></span>
<span><span class="co">## # ℹ 2 more variables: prediction &lt;dbl&gt;, unit &lt;chr&gt;</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">variable</span>, <span class="va">unit</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">datetime</span>, y <span class="op">=</span> <span class="va">prediction</span>, color <span class="op">=</span> <span class="va">ensemble</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">reference_datetime</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">variable</span>, scale <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 2204 rows containing missing values (`geom_line()`).</span></span></code></pre>
<div class="section level3">
<h3 id="downscaling-from-6-hour-to-1-hour-time-step">Downscaling from 6 hour to 1 hour time-step<a class="anchor" aria-label="anchor" href="#downscaling-from-6-hour-to-1-hour-time-step"></a>
</h3>
<p>The downscaling uses the GLM variables</p>
<pre><code><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">RopenMeteo</span><span class="fu">::</span><span class="fu"><a href="reference/get_seasonal_forecast.html">get_seasonal_forecast</a></span><span class="op">(</span></span>
<span>  latitude <span class="op">=</span> <span class="fl">37.30</span>,</span>
<span>  longitude <span class="op">=</span> <span class="op">-</span><span class="fl">79.83</span>,</span>
<span>  forecast_days <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  past_days <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  variables <span class="op">=</span> <span class="fu">RopenMeteo</span><span class="fu">::</span><span class="fu"><a href="reference/glm_variables.html">glm_variables</a></span><span class="op">(</span>product <span class="op">=</span> <span class="st">"seasonal_forecast"</span>,</span>
<span>                                        time_step <span class="op">=</span> <span class="st">"6hourly"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<pre><code><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">RopenMeteo</span><span class="fu">::</span><span class="fu"><a href="reference/six_hourly_to_hourly.html">six_hourly_to_hourly</a></span><span class="op">(</span>latitude <span class="op">=</span> <span class="fl">37.30</span>, longitude <span class="op">=</span> <span class="op">-</span><span class="fl">79.83</span>, use_solar_geom <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">variable</span>, <span class="va">unit</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">datetime</span>, y <span class="op">=</span> <span class="va">prediction</span>, color <span class="op">=</span> <span class="va">ensemble</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">reference_datetime</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">variable</span>, scale <span class="op">=</span> <span class="st">"free"</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
<pre><code><span><span class="co">## Registered S3 method overwritten by 'quantmod':</span></span>
<span><span class="co">##   method            from</span></span>
<span><span class="co">##   as.zoo.data.frame zoo</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="climate-projections">Climate Projections<a class="anchor" aria-label="anchor" href="#climate-projections"></a>
</h2>
<p>Climate projections from different models are available through 2050. The output is a daily time-step.</p>
<p>Note the units for shortwave radiation are different for the climate projection.</p>
<p><a href="https://open-meteo.com/en/docs/climate-api" class="external-link uri">https://open-meteo.com/en/docs/climate-api</a></p>
<pre><code><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">RopenMeteo</span><span class="fu">::</span><span class="fu"><a href="reference/get_climate_projections.html">get_climate_projections</a></span><span class="op">(</span></span>
<span>  latitude <span class="op">=</span> <span class="fl">37.30</span>,</span>
<span>  longitude <span class="op">=</span> <span class="op">-</span><span class="fl">79.83</span>,</span>
<span>  start_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  end_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/period.html" class="external-link">years</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"EC_Earth3P_HR"</span>,</span>
<span>  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"temperature_2m_mean"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre>
<pre><code><span><span class="co">## # A tibble: 6 × 6</span></span>
<span><span class="co">##   datetime   site_id     model_id      variable            prediction unit</span></span>
<span><span class="co">##   &lt;date&gt;     &lt;chr&gt;       &lt;chr&gt;         &lt;chr&gt;                    &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">## 1 2023-09-25 37.3_-79.83 EC_Earth3P_HR temperature_2m_mean       15.4 °C</span></span>
<span><span class="co">## 2 2023-09-26 37.3_-79.83 EC_Earth3P_HR temperature_2m_mean       16.2 °C</span></span>
<span><span class="co">## 3 2023-09-27 37.3_-79.83 EC_Earth3P_HR temperature_2m_mean       14.5 °C</span></span>
<span><span class="co">## 4 2023-09-28 37.3_-79.83 EC_Earth3P_HR temperature_2m_mean       12.4 °C</span></span>
<span><span class="co">## 5 2023-09-29 37.3_-79.83 EC_Earth3P_HR temperature_2m_mean       12.6 °C</span></span>
<span><span class="co">## 6 2023-09-30 37.3_-79.83 EC_Earth3P_HR temperature_2m_mean       13.2 °C</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span>variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">variable</span>, <span class="va">unit</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">datetime</span>, y <span class="op">=</span> <span class="va">prediction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#F8766D"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">variable</span>, scale <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="downloading-multiple-sites-or-models">Downloading multiple sites or models<a class="anchor" aria-label="anchor" href="#downloading-multiple-sites-or-models"></a>
</h2>
<div class="section level3">
<h3 id="multiple-models">Multiple models<a class="anchor" aria-label="anchor" href="#multiple-models"></a>
</h3>
<pre><code><span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CMCC_CM2_VHR4"</span>,<span class="st">"FGOALS_f3_H"</span>,<span class="st">"HiRAM_SIT_HR"</span>,<span class="st">"MRI_AGCM3_2_S"</span>,<span class="st">"EC_Earth3P_HR"</span>,<span class="st">"MPI_ESM1_2_XR"</span>,<span class="st">"NICAM16_8S"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span><span class="va">models</span>, <span class="kw">function</span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">RopenMeteo</span><span class="fu">::</span><span class="fu"><a href="reference/get_climate_projections.html">get_climate_projections</a></span><span class="op">(</span></span>
<span>    latitude <span class="op">=</span> <span class="fl">37.30</span>,</span>
<span>    longitude <span class="op">=</span> <span class="op">-</span><span class="fl">79.83</span>,</span>
<span>    start_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    end_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/period.html" class="external-link">years</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>    model <span class="op">=</span> <span class="va">model</span>,</span>
<span>    variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"temperature_2m_mean"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span></code></pre>
<pre><code><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">variable</span>, <span class="va">unit</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">datetime</span>, y <span class="op">=</span> <span class="va">prediction</span>, color <span class="op">=</span> <span class="va">model_id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">variable</span>, scale <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="multiple-sites">Multiple sites<a class="anchor" aria-label="anchor" href="#multiple-sites"></a>
</h3>
<p>The download of multiple sites uses the optional <code>site_id</code> to add column that denotes the different sites.</p>
<pre><code><span><span class="va">sites</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>site_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fcre"</span>, <span class="st">"sunp"</span><span class="op">)</span>,</span>
<span>                        latitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">37.30</span>, <span class="fl">43.39</span><span class="op">)</span>,</span>
<span>                        longitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">79.83</span>, <span class="op">-</span><span class="fl">72.05</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sites</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span>, <span class="va">sites</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">RopenMeteo</span><span class="fu">::</span><span class="fu"><a href="reference/get_climate_projections.html">get_climate_projections</a></span><span class="op">(</span></span>
<span>    latitude <span class="op">=</span> <span class="va">sites</span><span class="op">$</span><span class="va">latitude</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>    longitude <span class="op">=</span> <span class="va">sites</span><span class="op">$</span><span class="va">longitude</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>    site_id <span class="op">=</span> <span class="va">sites</span><span class="op">$</span><span class="va">site_id</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>    start_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    end_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/period.html" class="external-link">years</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>    model <span class="op">=</span> <span class="st">"MPI_ESM1_2_XR"</span>,</span>
<span>    variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"temperature_2m_mean"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span>,</span>
<span>  <span class="va">sites</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre>
<pre><code><span><span class="co">## # A tibble: 6 × 6</span></span>
<span><span class="co">##   datetime   site_id model_id      variable            prediction unit</span></span>
<span><span class="co">##   &lt;date&gt;     &lt;chr&gt;   &lt;chr&gt;         &lt;chr&gt;                    &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">## 1 2023-09-25 fcre    MPI_ESM1_2_XR temperature_2m_mean       14.7 °C</span></span>
<span><span class="co">## 2 2023-09-26 fcre    MPI_ESM1_2_XR temperature_2m_mean       17.8 °C</span></span>
<span><span class="co">## 3 2023-09-27 fcre    MPI_ESM1_2_XR temperature_2m_mean       19.3 °C</span></span>
<span><span class="co">## 4 2023-09-28 fcre    MPI_ESM1_2_XR temperature_2m_mean       21.6 °C</span></span>
<span><span class="co">## 5 2023-09-29 fcre    MPI_ESM1_2_XR temperature_2m_mean       15.9 °C</span></span>
<span><span class="co">## 6 2023-09-30 fcre    MPI_ESM1_2_XR temperature_2m_mean       11   °C</span></span></code></pre>
<pre><code><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">variable</span>, <span class="va">unit</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">datetime</span>, y <span class="op">=</span> <span class="va">prediction</span>, color <span class="op">=</span> <span class="va">site_id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">variable</span>, scale <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="converting-from-daily-to-hourly-time-step">Converting from daily to hourly time-step<a class="anchor" aria-label="anchor" href="#converting-from-daily-to-hourly-time-step"></a>
</h3>
<p>Photosynthesis is non-linearly sensitive to shortwave radiation. Therefore, the photosynthesis response to hourly radiation is different than the response to the aggregated daily mean radiation. To address this issue, we provide a function to convert the daily sum of shortwave radiation to hourly values that uses solar geometry to impute. Additionally, the sum of precipitation is divided by 24 hours to convert to an hourly time-step. All other variables have their daily mean applied to each hour.</p>
<pre><code><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">RopenMeteo</span><span class="fu">::</span><span class="fu"><a href="reference/get_climate_projections.html">get_climate_projections</a></span><span class="op">(</span></span>
<span>  latitude <span class="op">=</span> <span class="fl">37.30</span>,</span>
<span>  longitude <span class="op">=</span> <span class="op">-</span><span class="fl">79.83</span>,</span>
<span>  start_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  end_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/period.html" class="external-link">years</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"EC_Earth3P_HR"</span>,</span>
<span>  variables <span class="op">=</span> <span class="fu">RopenMeteo</span><span class="fu">::</span><span class="fu"><a href="reference/glm_variables.html">glm_variables</a></span><span class="op">(</span>product <span class="op">=</span> <span class="st">"climate_projection"</span>, time_step <span class="op">=</span> <span class="st">"daily"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<pre><code><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span> <span class="fu">RopenMeteo</span><span class="fu">::</span><span class="fu"><a href="reference/daily_to_hourly.html">daily_to_hourly</a></span><span class="op">(</span>latitude <span class="op">=</span> <span class="fl">37.30</span>, longitude <span class="op">=</span> <span class="op">-</span><span class="fl">79.83</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">variable</span>, <span class="va">unit</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">datetime</span>, y <span class="op">=</span> <span class="va">prediction</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#F8766D"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">variable</span>, scale <span class="op">=</span> <span class="st">"free"</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing RopenMeteo</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Quinn Thomas <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-1282-7825" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/FLARE-forecast/RopenMeteo/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/FLARE-forecast/RopenMeteo/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Quinn Thomas.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
